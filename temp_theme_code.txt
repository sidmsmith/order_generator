
  <html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Order Generator v1.2.3</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- CodeMirror for JSON syntax highlighting with folding support -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
>   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldgutter.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/json/json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldgutter.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/brace-fold.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/indent-fold.min.js"></script>
    <style>
>     /* Dark Theme (Default) */
      :root {
        --bg-dark: #121212;
        --card-bg: #1e1e1e;
        --input-bg: #2d2d2d;
        --border: #333;
        --text: #e0e0e0;
        --red-text: #ff6b6b;
        --blue-select: #339af0;
        --success: #28a745;
        --primary: #0d6efd;
      }
      
>     /* Manhattan Theme */
>     :root.theme-manhattan {
        --bg-dark: rgb(45, 47, 59);
        --card-bg: #484e5e;
        --input-bg: #282c34;
        --border: #333;
        --text: #495057;
        --red-text: #ff6b6b;
        --blue-select: #339af0;
        --success: hsl(142.1 76.2% 36.3%);
        --primary: #3B82F6;
        --secondary: #6c757d;
      .status { 
        font-weight: 600; 
        padding: 0.25rem 0;
        flex: 1;
      }
  
      .form-label { color: #bbbbbb; font-weight: 600; }
      small { color: #999; }
      h2 { color: var(--primary); }
      
>     /* Theme-specific text colors */
>     :root.theme-manhattan .form-label { color: #bbbbbb; }
>     :root.theme-manhattan small { color: #999; }
      
>     /* Theme selector gear icon */
>     .theme-selector-btn {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: none;
        border: none;
        color: var(--text);
        padding: 0.5rem;
        cursor: pointer;
        font-size: 1.5rem;
        z-index: 1000;
        transition: opacity 0.2s;
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
      }
>     .theme-selector-btn:hover {
        opacity: 0.7;
      }
      
>     /* Ensure gear icon is visible in all themes with proper contrast */
>     :root.theme-manhattan .theme-selector-btn {
        color: #495057;
      }
>     :root.theme-manhattan .theme-selector-btn:hover {
        color: #3B82F6;
      }
      
>     /* Modal styling */
>     .modal-content {
        background-color: var(--card-bg);
        color: var(--text);
        border: 1px solid var(--border);
      }
>     .modal-header, .modal-footer {
        border-color: var(--border);
      }
      .list-group-item {
        background-color: var(--input-bg);
        border-color: var(--border);
        color: var(--text);
      }
      .list-group-item:hover {
        background-color: var(--card-bg);
      }
      }
  
      .accordion-button:focus {
        box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
      }
  
      .accordion-body {
        background: var(--card-bg) !important;
      }
      
>     /* Manhattan theme: white text for collapsed accordion buttons */
>     :root.theme-manhattan .accordion-button {
        color: #ffffff !important;
      }
      
>     /* Manhattan theme: keep blue when expanded */
>     :root.theme-manhattan .accordion-button:not(.collapsed) {
        color: var(--primary) !important;
      }
  
      /* Summary fields section */
      .summary-section {
        background: var(--input-bg);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1rem;
      }
    </style>
  </head>
  <body>
    <div class="main-card" style="position: relative;">
>     <button class="theme-selector-btn" id="themeSelectorBtn" title="Select Theme">
>       <i class="fas fa-cog"></i>
      </button>
      <h2 class="text-center mb-4">Order Generator v1.2.3</h2>
  
      <!-- ORG -->
      <div id="authSection" class="mb-3">
        <label class="form-label">ORG:</label>
        <div class="d-flex align-items-center gap-2">
          <input type="text" id="org" class="form-control" placeholder="Enter ORG" maxlength="20" style="width: 250px; max-width: 100%;" />
          <button id="authBtn" class="btn btn-success px-4">Authenticate</button>
        </div>
        <div class="mt-4">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <label class="form-label mb-0">API Console (Testing):</label>
            <button type="button" id="clearConsoleBtn" class="btn btn-sm btn-secondary">Clear</button>
          </div>
          <div id="consoleOutput" class="console-output" style="height: 400px; overflow-y: auto;">Ready. Authenticate and load an order to begin.</div>
        </div>
      </div>
    </div>
  
>   <!-- THEME SELECTOR MODAL -->
>   <div class="modal fade" id="themeModal" tabindex="-1">
>     <div class="modal-dialog modal-dialog-centered">
>       <div class="modal-content">
>         <div class="modal-header">
>           <h5 class="modal-title">Select Theme</h5>
>           <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
          </div>
>         <div class="modal-body">
>           <div class="list-group" id="themeList"></div>
          </div>
        </div>
      </div>
    </div>
  
    <script>
      // DOM Elements
      const orgInput = document.getElementById('org');
      const authBtn = document.getElementById('authBtn');
      const mainUI = document.getElementById('mainUI');
        orgInput.value = urlOrg.trim();
        // Hide auth section when auto-authenticating
        const authSection = document.getElementById('authSection');
        if (authSection) {
          authSection.style.display = 'none';
        }
      } else {
        orgInput.value = '';
      }
      
>     // ===== THEME SYSTEM =====
>     const themeSelectorBtn = document.getElementById('themeSelectorBtn');
>     const themeModal = new bootstrap.Modal(document.getElementById('themeModal'));
>     const themeList = document.getElementById('themeList');
>     const THEME_STORAGE_KEY = 'order_generator_theme';
      
>     // Theme definitions
>     const themes = {
        dark: {
          name: 'Dark',
          rootClass: ''
        },
        manhattan: {
          name: 'Manhattan',
>         rootClass: 'theme-manhattan'
        }
      };
      
>     // Load saved theme or default to dark
>     function loadTheme() {
>       const savedTheme = localStorage.getItem(THEME_STORAGE_KEY) || 'dark';
>       applyTheme(savedTheme);
      }
      
>     // Apply theme
>     function applyTheme(themeName) {
        const root = document.documentElement;
>       const theme = themes[themeName] || themes.dark;
        
>       // Remove all theme classes
>       Object.values(themes).forEach(t => {
          if (t.rootClass) {
            root.classList.remove(t.rootClass);
          }
        });
        
>       // Apply selected theme
>       if (theme.rootClass) {
>         root.classList.add(theme.rootClass);
        }
        
        // Save to localStorage
>       localStorage.setItem(THEME_STORAGE_KEY, themeName);
      }
      
>     // Render theme list in modal
>     function renderThemeList() {
>       themeList.innerHTML = '';
>       const currentTheme = localStorage.getItem(THEME_STORAGE_KEY) || 'dark';
        
>       Object.entries(themes).forEach(([key, theme]) => {
          const item = document.createElement('button');
          item.type = 'button';
>         item.className = `list-group-item list-group-item-action ${key === currentTheme ? 'active' : ''}`;
>         item.textContent = theme.name;
          item.onclick = () => {
>           applyTheme(key);
>           themeModal.hide();
          };
>         themeList.appendChild(item);
        });
      }
      
>     // Theme selector button click handler
>     if (themeSelectorBtn) {
>       themeSelectorBtn.onclick = () => {
>         renderThemeList();
>         themeModal.show();
        };
        
>       // Ensure button is always visible after theme changes
        const observer = new MutationObserver(() => {
>         if (themeSelectorBtn) {
>           themeSelectorBtn.style.display = 'block';
>           themeSelectorBtn.style.visibility = 'visible';
          }
        });
        
>       // Observe theme class changes on root element
        observer.observe(document.documentElement, {
          attributes: true,
          attributeFilter: ['class']
        });
      }
      
>     // Load theme on page load
>     loadTheme();
      
>     // Ensure gear icon is visible after theme loads
>     if (themeSelectorBtn) {
        setTimeout(() => {
>         themeSelectorBtn.style.display = 'block';
>         themeSelectorBtn.style.visibility = 'visible';
        }, 100);
      }
  
      // Initialize CodeMirror editor
      function initJsonEditor() {
        if (jsonEditor) return;
        jsonEditor = CodeMirror.fromTextArea(jsonTextarea, {
          mode: { name: "javascript", json: true },
>         theme: "monokai",
          lineNumbers: true,
          indentUnit: 2,
          autoCloseBrackets: true,
          matchBrackets: true,
          lineWrapping: true,
          foldGutter: true,
          gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"]
        });
      }
  

